<p-dialog [(visible)]="dialog" [style]="{ width: '60rem' }" header="Detail of Answers" [modal]="true" [closable]="true">

  <div class="grid grid-cols-1 sm:grid-cols-6 gap-6 m:grid-cols-12 xl:grid-cols-12">

    <div class="p-6 sm:col-span-12 m:col-span-12 xl:col-span-12 ">
      <div class="grid grid-cols-4 gap-4 mb-6">

        <!-- Usuario -->
        <div class="bg-gray-50 p-4 rounded-lg h-full">
          <div class="flex items-center mb-2">
            <div class="w-8 h-8 flex items-center justify-center rounded-full mr-3 bg-blue-100 text-blue-600"
              ng-reflect-ng-class="bg-blue-100,text-blue-600"><svg xmlns="http://www.w3.org/2000/svg" width="15"
                height="15" viewBox="0 0 24 24">
                <path fill="currentColor"
                  d="M4 22a8 8 0 1 1 16 0h-2a6 6 0 0 0-12 0zm8-9c-3.315 0-6-2.685-6-6s2.685-6 6-6s6 2.685 6 6s-2.685 6-6 6m0-2c2.21 0 4-1.79 4-4s-1.79-4-4-4s-4 1.79-4 4s1.79 4 4 4">
                </path>
              </svg></div>
            <h3 class="font-medium text-gray-900">User</h3>
          </div>
          <p class="text-gray-600 ml-11">{{ testResult()?.testResultDto?.userEmail }}</p>
        </div>

        <!-- Test -->
        <div class="bg-gray-50 p-4 rounded-lg h-full">
          <div class="flex items-center mb-2">
            <div class="w-8 h-8 flex items-center justify-center rounded-full mr-3 bg-amber-100 text-amber-600"
              ng-reflect-ng-class="bg-amber-100,text-amber-600"><svg xmlns="http://www.w3.org/2000/svg" width="15"
                height="15" viewBox="0 0 24 24">
                <path fill="currentColor"
                  d="M21 8v12.993A1 1 0 0 1 20.007 22H3.993A.993.993 0 0 1 3 21.008V2.992C3 2.455 3.449 2 4.002 2h10.995zm-2 1h-5V4H5v16h14zM8 7h3v2H8zm0 4h8v2H8zm0 4h8v2H8z">
                </path>
              </svg></div>
            <h3 class="font-medium text-gray-900">Test</h3>
          </div>
          <p class="text-gray-600 ml-11">{{ testResult()?.testName }}</p>
        </div>

        <!-- Score -->
        <div class="bg-gray-50 p-4 rounded-lg h-full">
          <div class="flex items-center mb-2">
            <div class="w-8 h-8 flex items-center justify-center rounded-full mr-3 bg-rose-100 text-rose-600"
              ng-reflect-ng-class="bg-rose-100,text-rose-600"><svg xmlns="http://www.w3.org/2000/svg" width="24"
                height="24" viewBox="0 0 48 48">
                <path fill="currentColor" fill-rule="evenodd"
                  d="M12 7a1 1 0 0 1 1-1h22a1 1 0 0 1 1 1v1h5a1 1 0 0 1 1 1v6a5 5 0 0 1-5 5h-1.683c-1.541 4.36-5.53 7.564-10.317 7.959V34h7a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H16a1 1 0 0 1-1-1v-6a1 1 0 0 1 1-1h7v-6.041c-4.786-.395-8.776-3.599-10.317-7.959H11a5 5 0 0 1-5-5V9a1 1 0 0 1 1-1h5zm22 9V8H14v8c0 5.523 4.477 10 10 10s10-4.477 10-10m2-6v8h1a3 3 0 0 0 3-3v-5zM8 10h4v8h-1a3 3 0 0 1-3-3zm9 26v4h14v-4z"
                  clip-rule="evenodd" />
              </svg></div>

            <h3 class="font-medium text-gray-900">Score</h3>
          </div>
          <p class="text-gray-600 ml-11">{{
            `${testResult()?.testResultDto?.score}/${testResult()?.testResultDto?.testMaxScore}` }}</p>
        </div>

        <!-- Questions -->
        <div class="bg-gray-50 p-4 rounded-lg h-full">
          <div class="flex items-center mb-2">
            <div class="w-8 h-8 flex items-center justify-center rounded-full mr-3 bg-yellow-100 text-yellow-600"
              ng-reflect-ng-class="bg-yellow-100,text-yellow-600"><svg xmlns="http://www.w3.org/2000/svg" width="15"
                height="15" viewBox="0 0 24 24">
                <g fill="none">
                  <path
                    d="m12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035q-.016-.005-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093q.019.005.029-.008l.004-.014l-.034-.614q-.005-.018-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z">
                  </path>
                  <path fill="currentColor"
                    d="M12 2c5.523 0 10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12S6.477 2 12 2m0 2a8 8 0 1 0 0 16a8 8 0 0 0 0-16m0 12a1 1 0 1 1 0 2a1 1 0 0 1 0-2m0-9.5a3.625 3.625 0 0 1 1.348 6.99a.8.8 0 0 0-.305.201c-.044.05-.051.114-.05.18L13 14a1 1 0 0 1-1.993.117L11 14v-.25c0-1.153.93-1.845 1.604-2.116a1.626 1.626 0 1 0-2.229-1.509a1 1 0 1 1-2 0A3.625 3.625 0 0 1 12 6.5">
                  </path>
                </g>
              </svg></div>
            <h3 class="font-medium text-gray-900">Questions</h3>
          </div>
          <p class="text-gray-600 ml-11">{{ testResult()?.countAnswers }} of {{ testResult()?.countQuestions }}
            completed</p>
        </div>

        <!-- Start Date -->
        <div class="bg-gray-50 p-4 rounded-lg h-full">
          <div class="flex items-center mb-2">
            <div class="w-8 h-8 flex items-center justify-center rounded-full mr-3 bg-lime-100 text-lime-600"
              ng-reflect-ng-class="bg-lime-100,text-lime-600"><svg xmlns="http://www.w3.org/2000/svg" width="24"
                height="24" viewBox="0 0 24 24">
                <rect width="14" height="0" x="5" y="5" fill="currentColor">
                  <animate fill="freeze" attributeName="height" begin="0.6s" dur="0.2s" values="0;3" />
                </rect>
                <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1">
                  <path stroke-dasharray="64" stroke-dashoffset="64"
                    d="M12 4h7c0.55 0 1 0.45 1 1v14c0 0.55 -0.45 1 -1 1h-14c-0.55 0 -1 -0.45 -1 -1v-14c0 -0.55 0.45 -1 1 -1Z">
                    <animate fill="freeze" attributeName="stroke-dashoffset" dur="0.6s" values="64;0" />
                  </path>
                  <path stroke-dasharray="4" stroke-dashoffset="4" d="M7 4v-2M17 4v-2">
                    <animate fill="freeze" attributeName="stroke-dashoffset" begin="0.6s" dur="0.2s" values="4;0" />
                  </path>
                  <path stroke-dasharray="12" stroke-dashoffset="12" d="M7 11h10">
                    <animate fill="freeze" attributeName="stroke-dashoffset" begin="0.8s" dur="0.2s" values="12;0" />
                  </path>
                  <path stroke-dasharray="8" stroke-dashoffset="8" d="M7 15h7">
                    <animate fill="freeze" attributeName="stroke-dashoffset" begin="1s" dur="0.2s" values="8;0" />
                  </path>
                </g>
              </svg></div>
            <h3 class="font-medium text-gray-900">Start Date</h3>
          </div>
          <p class="text-gray-600 ml-11">{{ testResult()?.testResultDto?.startedAt | date:'dd/MM/yyyy HH:mm' }}</p>
        </div>

        <!-- Completion Date -->
        <div class="bg-gray-50 p-4 rounded-lg h-full">
          <div class="flex items-center mb-2">
            <div class="w-8 h-8 flex items-center justify-center rounded-full mr-3 bg-emerald-100 text-emerald-600"
              ng-reflect-ng-class="bg-emerald-100,text-emerald-600"><svg xmlns="http://www.w3.org/2000/svg" width="24"
                height="24" viewBox="0 0 24 24">
                <path fill="currentColor"
                  d="m10.562 15.908l6.396-6.396l-.708-.708l-5.688 5.688l-2.85-2.85l-.708.708zM12.003 21q-1.866 0-3.51-.708q-1.643-.709-2.859-1.924t-1.925-2.856T3 12.003t.709-3.51Q4.417 6.85 5.63 5.634t2.857-1.925T11.997 3t3.51.709q1.643.708 2.859 1.922t1.925 2.857t.709 3.509t-.708 3.51t-1.924 2.859t-2.856 1.925t-3.509.709M12 20q3.35 0 5.675-2.325T20 12t-2.325-5.675T12 4T6.325 6.325T4 12t2.325 5.675T12 20m0-8" />
              </svg></div>
            <h3 class="font-medium text-gray-900">Completion Date</h3>
          </div>
          <p class="text-gray-600 ml-11">{{ testResult()?.testResultDto?.completedAt | date:'dd/MM/yyyy HH:mm' }}</p>
        </div>

        <!-- Duration -->
        <div class="bg-gray-50 p-4 rounded-lg h-full">
          <div class="flex items-center mb-2">
            <div class="w-8 h-8 flex items-center justify-center rounded-full mr-3 bg-indigo-100 text-indigo-600"
              ng-reflect-ng-class="bg-indigo-100,text-indigo-600"><svg xmlns="http://www.w3.org/2000/svg" width="24"
                height="24" viewBox="0 0 24 24">
                <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1">
                  <circle cx="12" cy="12" r="9" />
                  <path d="M11 8v5h5" />
                </g>
              </svg></div>
            <h3 class="font-medium text-gray-900">Test Duration</h3>
          </div>
          <p class="text-gray-600 ml-11">{{ testDuration }}</p>
        </div>

        <!-- State -->
        <div class="bg-gray-50 p-4 rounded-lg h-full">
          <div class="flex items-center mb-2">
            <div class="w-8 h-8 flex items-center justify-center rounded-full mr-3 bg-cyan-100 text-cyan-600"
              ng-reflect-ng-class="bg-cyan-100,text-cyan-600"><svg xmlns="http://www.w3.org/2000/svg" width="24"
                height="24" viewBox="0 0 32 32">
                <path fill="currentColor"
                  d="M25 23h-.021a1 1 0 0 1-.94-.726L20.87 11.19l-1.935 5.16A1 1 0 0 1 18 17h-4v-2h3.307l2.757-7.351a1 1 0 0 1 1.898.076l3.111 10.892l1.979-5.933A1 1 0 0 1 28 12h4v2h-3.28l-2.772 8.316A1 1 0 0 1 25 23m-10 7h-2v-7a3.003 3.003 0 0 0-3-3H6a3.003 3.003 0 0 0-3 3v7H1v-7a5.006 5.006 0 0 1 5-5h4a5.006 5.006 0 0 1 5 5zM8 8a3 3 0 1 1-3 3a3 3 0 0 1 3-3m0-2a5 5 0 1 0 5 5a5 5 0 0 0-5-5" />
              </svg></div>
            <h3 class="font-medium text-gray-900">State</h3>
          </div>
          <p class="text-gray-600 ml-11">{{ getStatusName() | camelCaseToSpaces }}</p>
        </div>

      </div>

      <div class="mb-6">
        <h4 class="font-semibold text-lg text-gray-800 mb-4 flex items-center gap-2">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-primary" fill="none" viewBox="0 0 24 24"
            stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6l4 2m6-2a10 10 0 11-20 0 10 10 0 0120 0z" />
          </svg>
          Result Overview
        </h4>

        <div class="bg-purple-50 border border-purple-100 rounded-xl p-6 shadow-sm">

          <p class="inline-block text-sm px-3 py-1 rounded-full bg-primary/10 text-primary font-medium mb-2">
            {{ testResult()?.classification }}
          </p>

          <p class="text-sm text-gray-700 mb-4">
            {{ testResult()?.shortDescription }}
          </p>

          <ul class="space-y-3">
            @for (item of explanationList; track $index) {
            <li class="flex items-start">
              <div class="w-5 h-5 flex items-center justify-center bg-primary rounded-full mr-3 mt-0.5 shadow">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3" viewBox="0 0 16 16" fill="white">
                  <path
                    d="M13.488 3.43a.75.75 0 0 1 .081 1.058l-6 7a.75.75 0 0 1-1.1.042l-3.5-3.5A.75.75 0 0 1 4.03 6.97l2.928 2.927l5.473-6.385a.75.75 0 0 1 1.057-.081" />
                </svg>
              </div>
              <span class="text-sm text-gray-700">{{ item }}</span>
            </li>
            }
          </ul>

          <div class="mt-6 p-4 bg-gray-50 border-l-4 border-primary/40 rounded-lg">
            <p class="text-sm text-gray-700">
              <span class="font-semibold text-primary">Recommendations:</span>
              {{ testResult()?.recommendations }}
            </p>
          </div>
        </div>
      </div>

      <div>
        <h4 class="font-medium mb-3">Respuestas</h4>
        <p-dataview [value]="questionsResource.value()!" [rows]="5" [paginator]="true">
          <ng-template #list let-items>
            <div class="flex flex-col gap-4">
              <div *ngFor="let item of items" class="border border-gray-200 rounded-lg overflow-hidden">
                <div class="border border-gray-200 rounded-lg overflow-hidden">
                  <div class="bg-gray-50 p-4 border-b border-gray-200">
                    <p class="font-medium">{{ item.questionNumber }}. {{ item.text }}</p>
                  </div>
                  <div class="p-4">
                    <div class="flex items-start mb-2">
                      <div class="w-5 h-5 flex items-center justify-center mt-0.5 mr-2 text-red-500">
                        <i class="ri-close-line"></i>
                      </div>
                      <div>
                        <p>Intento mediar y buscar un punto medio entre las partes</p>
                        <p class="text-xs text-gray-500 mt-1">Respuesta seleccionada</p>
                      </div>
                    </div>
                    <div class="flex items-start mt-3 pt-3 border-t border-gray-100">
                      <div class="w-5 h-5 flex items-center justify-center mt-0.5 mr-2 text-gray-400">
                        <i class="ri-information-line"></i>
                      </div>
                      <div>
                        <p class="text-sm text-gray-600">Escucho activamente a todas las partes, identifico las
                          necesidades subyacentes y facilito una conversación constructiva</p>
                        <p class="text-xs text-green-600 mt-1">Respuesta correcta</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </ng-template>
        </p-dataview>
      </div>
    </div>

  </div>
  <div class="border-t pt-4 flex justify-end gap-3">
    <button type="button" (click)="closeModal()"
      class="inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50">
      <svg class="mr-2 h-5 w-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
      </svg>
      Cerrar
    </button>
  </div>

</p-dialog>
